<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>PixelUp SuperApp — Chat-First</title>
  <meta name="theme-color" content="#0b1a2a"/>
  <style>
    :root{ --bg:#0b1118; --panel:#0f1b2a; --muted:#9bb3c7; --primary:#12b0ff; --primary-2:#66d1ff; --accent:#00ffd5; --danger:#ff5d5d; --ok:#27c93f; --card:#0e1825; --border:#122235; --shadow:0 8px 28px rgba(0,0,0,.35); --radius:16px; }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:radial-gradient(1000px 600px at 10% -10%, rgba(18,176,255,.14), transparent 60%), radial-gradient(800px 500px at 110% 10%, rgba(0,255,213,.10), transparent 60%), var(--bg); color:#eaf6ff;}
    a{color:var(--primary); text-decoration:none}
    header.topbar{position:sticky;top:0;z-index:20;display:flex;gap:16px;align-items:center;justify-content:space-between;padding:14px 18px;background:rgba(11,20,32,.8);border-bottom:1px solid var(--border);backdrop-filter:blur(8px)}
    .brand{display:flex;align-items:center;gap:10px;font-weight:700}
    .brand .dot{width:10px;height:10px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--accent));box-shadow:0 0 12px rgba(18,176,255,.7),0 0 24px rgba(0,255,213,.5)}
    nav.tabs{display:flex;gap:8px;flex-wrap:wrap}
    nav.tabs button{background:#0b1522;color:#cfeaff;border:1px solid var(--border);padding:8px 12px;border-radius:999px;cursor:pointer}
    nav.tabs button.active{border-color:var(--primary);color:#fff;box-shadow:0 0 0 1px rgba(18,176,255,.25) inset}
    main{max-width:1200px;margin:24px auto;padding:0 16px}
    section.panel{display:none;background:rgba(15,27,42,.6);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px;margin-bottom:18px}
    section.panel.active{display:block}
    .grid{display:grid;gap:16px}.g-3{grid-template-columns:repeat(3,minmax(0,1fr))}.g-2{grid-template-columns:repeat(2,minmax(0,1fr))}
    .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:16px;box-shadow:var(--shadow)}
    .muted{color:var(--muted)} .badge{font-size:12px;padding:2px 8px;border-radius:999px;border:1px solid var(--border)}
    .btn{display:inline-flex;align-items:center;gap:8px;background:linear-gradient(135deg,var(--primary),var(--primary-2));color:#001726;border:none;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600;box-shadow:0 10px 22px rgba(0,0,0,.35),0 2px 0 rgba(0,0,0,.2) inset}
    .btn.secondary{background:#0b1522;color:#dff2ff;border:1px solid var(--border);box-shadow:none}
    .input,select,textarea{width:100%;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:#0c1725;color:#eaf6ff}
    .table{width:100%;border-collapse:collapse}.table th,.table td{border-bottom:1px solid var(--border);padding:10px;text-align:left}
    .chatbox{display:grid;grid-template-columns:280px 1fr;gap:16px}
    .list{overflow:auto;max-height:60vh} .thread{overflow:auto;max-height:60vh;padding:12px;background:#0b1522;border-radius:12px;border:1px solid var(--border)}
    .msg{margin:8px 0;padding:8px 10px;border-radius:10px;border:1px solid var(--border)} .msg.me{background:#062438} .msg.them{background:#112234}
    .ws-dot{width:10px;height:10px;border-radius:50%;background:#666}.ws-dot.on{background:#27c93f}.ws-dot.off{background:#ff5d5d}
    footer{color:#7fa6c2;text-align:center;padding:28px 12px}
    .gate{position:fixed;inset:0;background:linear-gradient(120deg,rgba(8,15,25,.96),rgba(8,15,25,.96));display:none;align-items:center;justify-content:center;z-index:100}
    .gate .box{width:min(420px,90vw);background:#0e1825;border:1px solid var(--border);border-radius:16px;box-shadow:0 0 30px rgba(0,0,0,.45);padding:18px}
  </style>
</head>
<body>
  <div class="gate" id="gate">
    <div class="box">
      <h2>Entrar</h2>
      <p class="muted">Proteção simples antes do Home (opcional).</p>
      <input class="input" id="gatePass" placeholder="Senha de acesso">
      <div class="badge muted" id="gateHint"></div>
      <div style="margin-top:12px" class="stack">
        <button class="btn" id="gateBtn">Entrar</button>
        <button class="btn secondary" id="gateSkip">Pular</button>
      </div>
    </div>
  </div>

  <header class="topbar">
    <div class="brand"><span class="dot"></span> PixelUp SuperApp</div>
    <nav class="tabs" id="tabs">
      <button data-tab="home" class="active">Home</button>
      <button data-tab="crm">CRM + Chat</button>
      <button data-tab="mentoria">Mentoria (8 módulos)</button>
    </nav>
    <div class="stack">
      <span class="ws-dot off" id="waDot"></span>
      <span id="waLabel" class="muted">WA: off</span>
      <span class="badge" id="botBadge">Bot: OFF</span>
      <button class="btn secondary" id="toggleBot">Ligar Bot</button>
    </div>
  </header>

  <main>
    <section class="panel active" id="panel-home">
      <div class="grid g-3">
        <div class="card">
          <h2>Hub da PixelUp — Chat-First</h2>
          <p class="muted">Mensagens no seu WhatsApp viram contatos no <b>CRM</b>. O <b>Gemini</b> responde quando o <b>Bot</b> está ligado.</p>
          <div class="stack">
            <button class="btn" data-goto="crm">Abrir CRM</button>
            <button class="btn secondary" data-goto="mentoria">Acessar Mentoria</button>
          </div>
        </div>
        <div class="card">
          <h3>Configurações rápidas</h3>
          <div class="stack">
            <input class="input" id="myNumber" placeholder="Seu número WA (55DDDNUMERO)">
            <button class="btn secondary" id="saveNumber">Salvar</button>
          </div>
          <small class="muted">Usado para evitar respostas automáticas para você mesmo.</small>
          <div style="margin-top:12px">
            <label class="muted" for="aiKey">Gemini API Key</label>
            <input class="input" id="aiKey" placeholder="COLOQUE_SUA_CHAVE_GEMINI">
            <button class="btn secondary" id="saveKey" style="margin-top:8px">Salvar Key</button>
          </div>
        </div>
        <div class="card">
          <h3>Status do WhatsApp</h3>
          <div class="stack">
            <span class="badge" id="waStatusText">off</span>
            <button class="btn secondary" id="btnCheckWA">Verificar</button>
          </div>
          <p class="muted">Conecta via <code>/api/*</code> (proxy Vercel → Replit).</p>
        </div>
      </div>
    </section>

    <section class="panel" id="panel-crm">
      <div class="grid g-2 chatbox">
        <div>
          <div class="card">
            <h3>Contatos (auto)</h3>
            <div class="list" id="contactsList"></div>
          </div>
          <div class="card">
            <h3>Novo contato</h3>
            <input class="input" id="cName" placeholder="Nome (opcional)">
            <input class="input" id="cPhone" placeholder="Telefone (WhatsApp)">
            <textarea class="input" id="cNotes" placeholder="Notas"></textarea>
            <button class="btn" id="btnAdd">Adicionar</button>
          </div>
        </div>
        <div>
          <div class="card">
            <h3 id="threadTitle">Conversa</h3>
            <div class="thread" id="thread"></div>
            <div class="stack" style="margin-top:8px">
              <input class="input" id="msgText" placeholder="Escreva uma mensagem">
              <button class="btn" id="sendMsg">Enviar</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="panel" id="panel-mentoria">
      <div class="grid g-2">
        <div class="card">
          <h3>Módulos</h3>
          <div id="modulesList"></div>
        </div>
        <div class="card">
          <h3 id="lessonTitle">Selecione um módulo</h3>
          <div id="lessonBody" class="muted">O conteúdo aparecerá aqui.</div>
        </div>
      </div>
    </section>
  </main>

  <script>
    window.ACCESS_PASS = ""; // Pre-Home Gate ("" = desativado)
    window.FEATURES = { PRELOGIN: true };
    window.PIXELUP_BOT_CONFIG = { WA_BASE_URL: "/api", API_TOKEN: "" };
    window.AI_CONFIG = { GEMINI_API_KEY: "" };
  </script>
  <script src="wa-bot/wa-bot.js"></script>
  <script type="module" src="js/chatfirst-crm.js"></script>
  <script type="module" src="js/mentoria.js"></script>
  <script src="js/app.js"></script>

  <footer>© PixelUp — SuperApp (Chat-First): Home • CRM + WhatsApp • Mentoria</footer>
</body>
</html>
